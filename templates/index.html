<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coffee Shop Revenue Predictor</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">
</head>
<body>

<div class="bg-wrap">
    <div class="container">
        <h1>☕ Coffee Shop Revenue Predictor</h1>
        <p class="subtitle">Predict your estimated daily revenue using business insights</p>

        {% if model_error %}
        <div class="error-box">
            <strong>Model Load Error:</strong>
            <p>{{ model_error }}</p>
        </div>
        {% endif %}

        <form id="predict-form" action="/predict" method="POST">
            <div class="grid">
                {% for f in features %}
                <div class="input-group">
                    <input required type="number" step="any" name="{{ f }}" id="{{ f }}">
                    <label for="{{ f }}">{{ f.replace('_',' ') }}</label>
                </div>
                {% endfor %}
            </div>

            <button type="submit" class="btn">Predict Revenue</button>
        </form>

        <div id="result" class="result-card" hidden>
            <h2>Estimated Revenue</h2>
            <p id="prediction-text"></p>

            <h4>Input Summary</h4>
            <pre id="input-json"></pre>
        </div>

        <div id="err" class="error-box" hidden></div>
    </div>
</div>

<script>
    const form = document.getElementById("predict-form");
    const resultCard = document.getElementById("result");
    const predictionText = document.getElementById("prediction-text");
    const inputJson = document.getElementById("input-json");
    const errBox = document.getElementById("err");

    form.addEventListener("submit", async (e) => {
        e.preventDefault();
        errBox.hidden = true;
        resultCard.hidden = true;

        const formData = new FormData(form);

        try {
            const response = await fetch(form.action, {
                method: "POST",
                body: formData,
            });

            const data = await response.json();

            if (!data.success) {
                errBox.textContent = data.error;
                errBox.hidden = false;
                return;
            }

            predictionText.textContent = "₹ " + Number(data.prediction).toFixed(2);
            inputJson.textContent = JSON.stringify(data.input, null, 2);

            resultCard.hidden = false;
            resultCard.classList.add("fadeIn");

        } catch (error) {
            errBox.textContent = error.toString();
            errBox.hidden = false;
        }
    });
</script>

</body>
</html>
